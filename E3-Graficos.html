<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Raymond L. Tremblay" />


<title>Tema_3_Graficos</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANALITICA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Estadistica basica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Introducción.html">¿Qué es la Estadística?</a>
    </li>
    <li>
      <a href="TallerRFE_I.html">Introducción a R, Rstudio y RMarkdown</a>
    </li>
    <li>
      <a href="Tema_2_Historia.html">Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="Tema_3_Graficos.html">Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="Tema_4_supuestos.html">Los Supuestos de las pruebas paramétricas</a>
    </li>
    <li>
      <a href="TallerRFE_II.html">Regresión simple y ANOVA</a>
    </li>
    <li>
      <a href="TRAvanzado.html">Modelos Lineales</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Visualización
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="G1-ggplot2.html">Qué es la visualización de datos y ejemplos historicos</a>
    </li>
    <li>
      <a href="G2-Errores-tipicos-en-la-visualizacion.html">Errores típicos en la visualización</a>
    </li>
    <li>
      <a href="G3-Graficos-por-conteos.html">Gráficos para conteos</a>
    </li>
    <li>
      <a href="G4-Grafico-de-puntos-de-Wilkinson.html">Gráficos de puntos de Wilkinson</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sreencasts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="screencast_t_test.html">t-test Screencast</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ejercicios
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Plataforma.html">Lo básico de RStudio</a>
    </li>
    <li>
      <a href="RMarkdown.html">Lo básico de RMarkdown</a>
    </li>
    <li>
      <a href="Tendencias_Centrales.html"> Tendencias Centrales</a>
    </li>
    <li>
      <a href="Medidas_Dispersión.html"> Medidas de Dispersión</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Talleres
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Descipción_de_Talleres.html">Tabla de Talleres Futuros</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="HIV.html">Datos sobre HIV</a>
    </li>
    <li>
      <a href="COVID-19.html">COVID-19</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Tema_3_Graficos</h1>
<h4 class="author">Raymond L. Tremblay</h4>
<h4 class="date">el 4 de febrero, 2020</h4>

</div>


<pre class="r"><code>library(ggplot2)
library(Hmisc)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: &#39;Hmisc&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     format.pval, units</code></pre>
<p>La información utilizada en este documento proviene en parte del libro <em>Discovering Statistics using R</em> por Andy Field, Jeremy Miles y Zoë Field.</p>
<div id="como-crear-una-gráfica-de-regresión-lineal-usando-ggplot" class="section level1">
<h1>Como crear una gráfica de regresión lineal usando ggplot</h1>
<ol style="list-style-type: decimal">
<li>Subir los datos “ExamAnxiety” Los archivos de datos que se usan en el libro se encuentran en este enlace, <a href="https://studysites.sagepub.com/dsur/study/articles.htm" class="uri">https://studysites.sagepub.com/dsur/study/articles.htm</a></li>
</ol>
<div id="see-page-136-in-book" class="section level2">
<h2>see page 136 in book</h2>
<p>DATA FILE = Exam Anxiety</p>
<pre class="r"><code>library(readr)
Exam_Anxiety &lt;- read_csv(&quot;Data/Exam Anxiety.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Code = col_double(),
##   Revise = col_double(),
##   Exam = col_double(),
##   Anxiety = col_double(),
##   Gender = col_character()
## )</code></pre>
<pre class="r"><code>head(Exam_Anxiety, n=1)</code></pre>
<pre><code>## # A tibble: 1 x 5
##    Code Revise  Exam Anxiety Gender
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; 
## 1     1      4    40    86.3 Male</code></pre>
<pre class="r"><code>tail(Exam_Anxiety, n=2)</code></pre>
<pre><code>## # A tibble: 2 x 5
##    Code Revise  Exam Anxiety Gender
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; 
## 1   102      9    40    79.0 Male  
## 2   103     20    50    91.1 Female</code></pre>
<pre class="r"><code>Anxiety = Exam_Anxiety
Exam_Anxiety = Anxiety
examData=Anxiety</code></pre>
<pre class="r"><code>head(Exam_Anxiety)  #cuando no pone n=, se ve los primepors 6</code></pre>
<pre><code>## # A tibble: 6 x 5
##    Code Revise  Exam Anxiety Gender
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; 
## 1     1      4    40    86.3 Male  
## 2     2     11    65    88.7 Female
## 3     3     27    80    70.2 Male  
## 4     4     53    80    61.3 Male  
## 5     5      4    40    89.5 Male  
## 6     6     22    70    60.5 Female</code></pre>
<pre class="r"><code>tail(Exam_Anxiety, n=3)</code></pre>
<pre><code>## # A tibble: 3 x 5
##    Code Revise  Exam Anxiety Gender
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; 
## 1   101      1     2    82.3 Male  
## 2   102      9    40    79.0 Male  
## 3   103     20    50    91.1 Female</code></pre>
</div>
</div>
<div id="medida-de-tendencia-central" class="section level1">
<h1>Medida de tendencia central</h1>
</div>
<div id="calculate-the-mean" class="section level1">
<h1>Calculate the mean</h1>
<pre class="r"><code>x=c(1,2,3,4,5,6,7,8,9,10, 1100)
d=c(2:100)
mean(x)</code></pre>
<pre><code>## [1] 105</code></pre>
<pre class="r"><code>mean(d)</code></pre>
<pre><code>## [1] 51</code></pre>
<pre class="r"><code>d</code></pre>
<pre><code>##  [1]   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20
## [20]  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39
## [39]  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58
## [58]  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77
## [77]  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96
## [96]  97  98  99 100</code></pre>
</div>
<div id="range" class="section level1">
<h1>range</h1>
<pre class="r"><code>range(d)</code></pre>
<pre><code>## [1]   2 100</code></pre>
<pre class="r"><code>median(x)</code></pre>
<pre><code>## [1] 6</code></pre>
<p>#Interquartile Range</p>
<pre class="r"><code>quantile(x)</code></pre>
<pre><code>##     0%    25%    50%    75%   100% 
##    1.0    3.5    6.0    8.5 1100.0</code></pre>
<pre class="r"><code>quantile(x, probs = c(0.015, 0.25, 0.50,.75, .975)) #Selecionar los quantiles.  </code></pre>
<pre><code>##   1.5%    25%    50%    75%  97.5% 
##   1.15   3.50   6.00   8.50 827.50</code></pre>
<pre class="r"><code>mean(Exam_Anxiety$Revise)</code></pre>
<pre><code>## [1] 19.85437</code></pre>
<pre class="r"><code>range(Exam_Anxiety$Revise)</code></pre>
<pre><code>## [1]  0 98</code></pre>
<pre class="r"><code>y=rnorm(1001)
head(y)</code></pre>
<pre><code>## [1]  0.9913244  1.2571452  0.8102876 -1.3324186  1.2516524  0.6627794</code></pre>
<pre class="r"><code>quantile(y)</code></pre>
<pre><code>##         0%        25%        50%        75%       100% 
## -3.7399772 -0.6189323 -0.0492724  0.6821106  3.0657053</code></pre>
<pre class="r"><code>probs = c(0.01, 0.10, 0.50,.90)</code></pre>
<p>How to do a simple linear point graph and add text to graph, change the axis name</p>
<pre class="r"><code>library(ggplot2)
#names(Exam_Anxiety) # para seber el nombre de las columnas

ggplot(Exam_Anxiety, aes(y=Exam, x=Anxiety))+ 
  geom_line(colour=&quot;#308A8C&quot;)</code></pre>
<p><img src="E3-Graficos_files/figure-html/linear%20graph-1.png" width="672" /></p>
<pre class="r"><code>tail(iris)</code></pre>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 145          6.7         3.3          5.7         2.5 virginica
## 146          6.7         3.0          5.2         2.3 virginica
## 147          6.3         2.5          5.0         1.9 virginica
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica</code></pre>
<pre class="r"><code>ggplot(iris, aes(Sepal.Length, Petal.Length)) +
      geom_point(aes(col = Species)) +
  geom_smooth(method=&quot;lm&quot;, colour=&quot;aquamarine&quot;) +  # lm is for linear model 
  labs(x = &quot;El largo del Sepalo&quot;, y = &quot;El largo del Petalo&quot;)+
  ggtitle(&quot;Basic geom_point and linear regression&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="E3-Graficos_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code># How to add a title, &quot;ggtitle&quot;

# How to save a Graph

ggsave(&quot;Iris_size.png&quot;) # .jpeg/.jpg/.tiff</code></pre>
<pre><code>## Saving 7 x 5 in image
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre class="r"><code>#Simple scatter with regression line
scatter &lt;- ggplot(examData, aes(Anxiety, Exam))
scatter + geom_point(shape=20, colour=&quot;red&quot;) + 
          geom_smooth(method = &quot;lm&quot;, colour = &quot;blue&quot;, se = F) +  # se = F, remueve el intervalo de confianza
  labs(x = &quot;Exam Anxiety&quot;, y = &quot;Exam Performance %&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="E3-Graficos_files/figure-html/more%20examples-1.png" width="672" /></p>
<p>#Simple scatter with regression line + CI</p>
<pre class="r"><code>scatter &lt;- ggplot(examData, aes(Anxiety, Exam))
scatter + geom_point() + 
          geom_smooth(method = &quot;lm&quot;, colour = &quot;Red&quot;)+ 
  labs(x = &quot;Exam Anxiety&quot;, y = &quot;Exam Performance %&quot;) </code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="E3-Graficos_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>#Regresión lineal más el intervalo de confianza.</p>
<pre class="r"><code>scatter &lt;- ggplot(examData, aes(Anxiety, Exam))
scatter + geom_point() + 
  geom_smooth(method = &quot;lm&quot;, colour = &quot;Red&quot;, alpha = 0.2, fill = &quot;orange&quot;) + 
  labs(x = &quot;Exam Anxiety&quot;, y = &quot;Exam Performance %&quot;) </code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="E3-Graficos_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>#Regresión lineal más el intervalo de confianza, usar “colour” por multiples grupos.</p>
<pre class="r"><code>names(Exam_Anxiety)</code></pre>
<pre><code>## [1] &quot;Code&quot;    &quot;Revise&quot;  &quot;Exam&quot;    &quot;Anxiety&quot; &quot;Gender&quot;</code></pre>
<pre class="r"><code>ggplot(Exam_Anxiety, aes(y=Exam, x=Anxiety, colour=Gender))+ 
  geom_point(colour=&quot;coral&quot;)+
  geom_smooth(method=&quot;lm&quot;) +  # lm is for linear model 
  labs(x = &quot;Exam Anxiety Score&quot;, y = &quot;Exam Performance %&quot;)+
  ggtitle(&quot;Basic geom_point and linear regression&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="E3-Graficos_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="constructing-histograms" class="section level1">
<h1>Constructing histograms</h1>
<div id="data-needed-are-from-festivaldata" class="section level2">
<h2>Data needed are from festivalData</h2>
<p>A biologist was worried about the potential health effects of music festivals. So, one year she went to the Download Festival in UK (Download Festival UK). She measured the higiene of 810 concert goes over the 3 day festival. Each day she attempted find all the individuals she census on the first day. + 0 = you smell like a corpse, that is left to rot + 4 = you smell of sweet roses on fresh spring day</p>
<p>The hypothesis is that the personal hygiene of the concert goers would go down dramatically over the 3 days of the festival.</p>
<pre class="r"><code>library(readr)
DownloadFestival &lt;- read_csv(&quot;Data/DownloadFestival.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   ticknumb = col_double(),
##   gender = col_character(),
##   day1 = col_double(),
##   day2 = col_double(),
##   day3 = col_double()
## )</code></pre>
<pre class="r"><code>FD=DownloadFestival
head(FD)  # ver las 6 primeras filas</code></pre>
<pre><code>## # A tibble: 6 x 5
##   ticknumb gender  day1  day2   day3
##      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1     2111 Male    2.64  1.35  1.61 
## 2     2229 Female  0.97  1.41  0.290
## 3     2338 Male    0.84 NA    NA    
## 4     2384 Female  3.03 NA    NA    
## 5     2401 Female  0.88  0.08 NA    
## 6     2405 Male    0.85 NA    NA</code></pre>
<pre class="r"><code>length(FD$ticknumb)  # cuantas filas</code></pre>
<pre><code>## [1] 810</code></pre>
<p>Constructing histograms and detecting outliers</p>
<pre class="r"><code>head(FD, n=2)</code></pre>
<pre><code>## # A tibble: 2 x 5
##   ticknumb gender  day1  day2  day3
##      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     2111 Male    2.64  1.35 1.61 
## 2     2229 Female  0.97  1.41 0.290</code></pre>
<pre class="r"><code>tail(FD)</code></pre>
<pre><code>## # A tibble: 6 x 5
##   ticknumb gender  day1  day2  day3
##      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     4749 Female  0.52 NA       NA
## 2     4756 Female  2.91  0.94    NA
## 3     4758 Female  2.61  1.44    NA
## 4     4759 Female  1.47 NA       NA
## 5     4760 Male    1.28 NA       NA
## 6     4765 Female  1.26 NA       NA</code></pre>
<pre class="r"><code>head(FD)</code></pre>
<pre><code>## # A tibble: 6 x 5
##   ticknumb gender  day1  day2   day3
##      &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1     2111 Male    2.64  1.35  1.61 
## 2     2229 Female  0.97  1.41  0.290
## 3     2338 Male    0.84 NA    NA    
## 4     2384 Female  3.03 NA    NA    
## 5     2401 Female  0.88  0.08 NA    
## 6     2405 Male    0.85 NA    NA</code></pre>
<pre class="r"><code> ggplot(FD, aes(day1))+ 
  geom_histogram(colour=&quot;white&quot;, fill=&quot;steelblue&quot;) + 
  labs(x = &quot;Hygiene (Day 1 of Festival)&quot;, y = &quot;Frequency&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="E3-Graficos_files/figure-html/histograms-1.png" width="672" /></p>
<pre class="r"><code>  summary(DownloadFestival)</code></pre>
<pre><code>##     ticknumb       gender               day1             day2       
##  Min.   :2111   Length:810         Min.   : 0.020   Min.   :0.0000  
##  1st Qu.:3096   Class :character   1st Qu.: 1.312   1st Qu.:0.4100  
##  Median :3620   Mode  :character   Median : 1.790   Median :0.7900  
##  Mean   :3616                      Mean   : 1.793   Mean   :0.9609  
##  3rd Qu.:4155                      3rd Qu.: 2.230   3rd Qu.:1.3500  
##  Max.   :4765                      Max.   :20.020   Max.   :3.4400  
##                                                     NA&#39;s   :546     
##       day3       
##  Min.   :0.0200  
##  1st Qu.:0.4400  
##  Median :0.7600  
##  Mean   :0.9765  
##  3rd Qu.:1.5250  
##  Max.   :3.4100  
##  NA&#39;s   :687</code></pre>
<pre class="r"><code>#binwidth = 0.6, fill=&quot;orange&quot;, colour=&quot;white&quot;</code></pre>
<p>Subsetting data = removing values larger than x</p>
<pre class="r"><code>Festivalday1=subset(DownloadFestival, day1&lt;5)
summary(Festivalday1)</code></pre>
<pre><code>##     ticknumb       gender               day1            day2       
##  Min.   :2111   Length:809         Min.   :0.020   Min.   :0.0000  
##  1st Qu.:3096   Class :character   1st Qu.:1.310   1st Qu.:0.4100  
##  Median :3620   Mode  :character   Median :1.790   Median :0.7900  
##  Mean   :3616                      Mean   :1.771   Mean   :0.9553  
##  3rd Qu.:4154                      3rd Qu.:2.230   3rd Qu.:1.3350  
##  Max.   :4765                      Max.   :3.690   Max.   :3.4400  
##                                                    NA&#39;s   :546     
##       day3       
##  Min.   :0.0200  
##  1st Qu.:0.4400  
##  Median :0.7600  
##  Mean   :0.9765  
##  3rd Qu.:1.5250  
##  Max.   :3.4100  
##  NA&#39;s   :686</code></pre>
<pre class="r"><code>festivalHistogram &lt;- ggplot(Festivalday1, aes(day1))
festivalHistogram + 
  geom_histogram(fill=&quot;orange&quot;, colour=&quot;white&quot;) + 
  labs(x = &quot;Hygiene (Day 1 of Festival)&quot;, y = &quot;Frequency&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="E3-Graficos_files/figure-html/no%20outliers-1.png" width="672" /></p>
<p>How to create boxplots</p>
<pre class="r"><code>festivalBoxplot &lt;- ggplot(Festivalday1, aes(x=1,y=day1))
festivalBoxplot + geom_boxplot() + labs(x = &quot;Gender&quot;, y = &quot;Hygiene (Day 1 of Festival)&quot;)</code></pre>
<p><img src="E3-Graficos_files/figure-html/boxplots2-1.png" width="672" /></p>
<p>Boxplot by Gender</p>
<pre class="r"><code>names(Festivalday1)</code></pre>
<pre><code>## [1] &quot;ticknumb&quot; &quot;gender&quot;   &quot;day1&quot;     &quot;day2&quot;     &quot;day3&quot;</code></pre>
<pre class="r"><code>festivalBoxplot &lt;- ggplot(Festivalday1, aes(x=gender,y=day2, colour=gender))
festivalBoxplot + 
  geom_point()+
  geom_boxplot(fill=&quot;yellow&quot;, alpha=0.1) + 
  labs(x = &quot;Gender&quot;, y = &quot;Hygiene (Day 2 of Festival)&quot;)</code></pre>
<pre><code>## Warning: Removed 546 rows containing non-finite values (stat_boxplot).</code></pre>
<pre><code>## Warning: Removed 546 rows containing missing values (geom_point).</code></pre>
<p><img src="E3-Graficos_files/figure-html/boxplots-1.png" width="672" /></p>
<p>How to detect outliers. Determine the % of data which are outliers (IN Spanish, sesgado) NOTE: that I’m constructing a function, which does not exist</p>
<pre class="r"><code>#--------OUTLIERS----------


outlierSummary&lt;-function(variable, digits = 2){
  
  zvariable&lt;-(variable-mean(variable, na.rm = TRUE))/sd(variable, na.rm = TRUE)
  
  outlier95&lt;-abs(zvariable) &gt;= 1.96  # error de 95%
  outlier99&lt;-abs(zvariable) &gt;= 2.58   # error de 99%
  outlier999&lt;-abs(zvariable) &gt;= 3.29  # error de 99.9%
  
  ncases&lt;-length(na.omit(zvariable))
  
  percent95&lt;-round(100*length(subset(outlier95, outlier95 == TRUE))/ncases, digits)
  percent99&lt;-round(100*length(subset(outlier99, outlier99 == TRUE))/ncases, digits)
  percent999&lt;-round(100*length(subset(outlier999, outlier999 == TRUE))/ncases, digits)
  
  cat(&quot;Absolute z-score greater than 1.96 = &quot;, percent95, &quot;%&quot;, &quot;\n&quot;)
  cat(&quot;Absolute z-score greater than 2.58 = &quot;,  percent99, &quot;%&quot;, &quot;\n&quot;)
  cat(&quot;Absolute z-score greater than 3.29 = &quot;,  percent999, &quot;%&quot;, &quot;\n&quot;)
}

outlierSummary(FD$day3)</code></pre>
<pre><code>## Absolute z-score greater than 1.96 =  4.07 % 
## Absolute z-score greater than 2.58 =  2.44 % 
## Absolute z-score greater than 3.29 =  0.81 %</code></pre>
<p>How to do a BOXPLOT of the distribution of the data, no assuming normal distribution.</p>
<p>In this figure we show the median and the percentiles and the outliers</p>
<pre class="r"><code>library(ggplot2)
ggplot(FD, aes(gender, day1))+ geom_boxplot()</code></pre>
<p><img src="E3-Graficos_files/figure-html/boxplot-1.png" width="672" /></p>
<p>Now to remove outliers</p>
<pre class="r"><code>Festivalday1</code></pre>
<pre><code>## # A tibble: 809 x 5
##    ticknumb gender  day1  day2   day3
##       &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1     2111 Male    2.64  1.35  1.61 
##  2     2229 Female  0.97  1.41  0.290
##  3     2338 Male    0.84 NA    NA    
##  4     2384 Female  3.03 NA    NA    
##  5     2401 Female  0.88  0.08 NA    
##  6     2405 Male    0.85 NA    NA    
##  7     2467 Female  1.56 NA    NA    
##  8     2478 Female  3.02 NA    NA    
##  9     2490 Male    2.29 NA    NA    
## 10     2504 Female  1.11  0.44  0.55 
## # … with 799 more rows</code></pre>
<pre class="r"><code>ggplot(Festivalday1, aes(gender, day1))+ geom_boxplot()</code></pre>
<p><img src="E3-Graficos_files/figure-html/boxplot2-1.png" width="672" /> #Line and error bars</p>
<ol style="list-style-type: decimal">
<li>Learn how to reformat data in the correct type of data frame (as the original data set is not in the correct format) with the function “stack”</li>
<li>How to add the mean of the variable with “stat_summary”</li>
<li>How to connect the mean with a line and change color</li>
<li>how to add the error bars and color (The 95% confidence intervals, created with the stat_summary() function and the “mean_cl_boot” argument are bootstrap confidence intervals using the smean.cl.boot() function in Hmisc)</li>
</ol>
</div>
<div id="install-libraryhmisc" class="section level2">
<h2>Install library(Hmisc)</h2>
<pre class="r"><code>library(Hmisc) # you need this package to add the confidence interval

library(readr)
Hiccups &lt;- read_csv(&quot;Data/Hiccups.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Baseline = col_double(),
##   Tongue = col_double(),
##   Carotid = col_double(),
##   Rectum = col_double()
## )</code></pre>
<pre class="r"><code>#hiccupsData=Hiccups

hiccups&lt;-stack(Hiccups) # to reorganize the data in two columns 
head(hiccups)</code></pre>
<pre><code>##   values      ind
## 1     15 Baseline
## 2     13 Baseline
## 3      9 Baseline
## 4      7 Baseline
## 5     11 Baseline
## 6     14 Baseline</code></pre>
<pre class="r"><code>tail(hiccups)</code></pre>
<pre><code>##    values    ind
## 55      4 Rectum
## 56      4 Rectum
## 57      4 Rectum
## 58      4 Rectum
## 59      2 Rectum
## 60      3 Rectum</code></pre>
<pre class="r"><code>names(hiccups)=c(&quot;Num_Hiccups&quot;,&quot;Intervention&quot;) # change the names of columns
#hiccups$Intervention_Factor &lt;- factor(hiccups$Intervention, levels = hiccups$Intervention)
head(hiccups)</code></pre>
<pre><code>##   Num_Hiccups Intervention
## 1          15     Baseline
## 2          13     Baseline
## 3           9     Baseline
## 4           7     Baseline
## 5          11     Baseline
## 6          14     Baseline</code></pre>
<pre class="r"><code>ggplot(hiccups, aes(y=Num_Hiccups,x=Intervention))+ 
  stat_summary(fun.y = &quot;mean&quot;, geom = &quot;point&quot;) + 
  stat_summary(fun.y = &quot;mean&quot;, geom = &quot;line&quot;, aes(group = 1),colour = &quot;Red&quot;, linetype = &quot;dashed&quot;) +      
  stat_summary(fun.data = mean_cl_boot, geom = &quot;errorbar&quot;, width = 0.2, colour=&quot;blue&quot;) + 
  labs(x = &quot;Intervention&quot;, y = &quot;Mean Number of Hiccups&quot;)</code></pre>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.

## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<p><img src="E3-Graficos_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>ggplot(hiccups, aes(y=Num_Hiccups,x=Intervention))+ 
  stat_summary(fun.y = mean, geom = &quot;point&quot;) + 
  stat_summary(fun.y = mean, geom = &quot;line&quot;, aes(group = 1),colour = &quot;Red&quot;, linetype = &quot;dashed&quot;) +      
  stat_summary(fun.data = mean_cl_boot, geom = &quot;errorbar&quot;, width = 0.2, colour=&quot;blue&quot;) + 
  labs(x = &quot;Intervention&quot;, y = &quot;Mean Number of Hiccups&quot;)</code></pre>
<pre><code>## Warning: `fun.y` is deprecated. Use `fun` instead.

## Warning: `fun.y` is deprecated. Use `fun` instead.</code></pre>
<p><img src="E3-Graficos_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
