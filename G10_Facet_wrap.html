<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="RLT" />


<title>Facet_wrap</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANALITICA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Estadística básica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="E1-Introducción.html">¿Qué es la Estadística?</a>
    </li>
    <li>
      <a href="E2-Historia.html">Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="E3-TallerRFE_I.html">Introducción a R, Rstudio y RMarkdown</a>
    </li>
    <li>
      <a href="E4-Graficos.html">Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="E5-supuestos.html">Los Supuestos de las pruebas paramétricas</a>
    </li>
    <li>
      <a href="E6-TallerRFE_II.html">Regresión simple y ANOVA</a>
    </li>
    <li>
      <a href="E7-TRAvanzado.html">Modelos Lineales</a>
    </li>
    <li>
      <a href="E8-Tipos_de_Datos.html">Tipos de Datos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Visualización
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="G1-ggplot2.html">Qué es la visualización de datos y ejemplos historicos</a>
    </li>
    <li>
      <a href="G2-Errores-tipicos-en-la-visualizacion.html">Errores típicos en la visualización</a>
    </li>
    <li>
      <a href="G3-Graficos-por-conteos.html">Gráficos para conteos</a>
    </li>
    <li>
      <a href="G4-Grafico-de-puntos-de-Wilkinson.html">Gráficos de puntos de Wilkinson</a>
    </li>
    <li>
      <a href="G5_geom_area_densidad_freqpoly.html">Gráficos de area y densidad</a>
    </li>
    <li>
      <a href="G6_geom_histogram.html">Histogramas</a>
    </li>
    <li>
      <a href="G7_geom_bar.html">Gráficos de barras</a>
    </li>
    <li>
      <a href="G8_geom_boxplot_geom_violin.html">Gráficos de caja y de violín</a>
    </li>
    <li>
      <a href="G9_Facet_Grid.html">Facet Grid</a>
    </li>
    <li>
      <a href="G10_Facet_wrap.html">Facet Wrap</a>
    </li>
    <li>
      <a href="G11_EVALUANDO_SUPUESTOS.html">Evaluando Supuestos</a>
    </li>
    <li>
      <a href="G12_Mapas_Calor.html">Mapas de Calor</a>
    </li>
    <li>
      <a href="G13_geom_line.html">Gráficos con lineas</a>
    </li>
    <li>
      <a href="G14_geom_point_geom_jitter.html">Geom_point y geom_jitter</a>
    </li>
    <li>
      <a href="G15_gganimate.html">Gráficos animados en movimiento</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sreencasts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="screencast_t_test.html">t-test Screencast</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ejercicios
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Plataforma.html">Lo básico de RStudio</a>
    </li>
    <li>
      <a href="RMarkdown.html">Lo básico de RMarkdown</a>
    </li>
    <li>
      <a href="Tendencias_Centrales.html"> Tendencias Centrales</a>
    </li>
    <li>
      <a href="Medidas_Dispersión.html"> Medidas de Dispersión</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Talleres
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Descipción_de_Talleres.html">Tabla de Talleres Futuros</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="HIV.html">Datos sobre HIV</a>
    </li>
    <li>
      <a href="COVID-19.html">COVID-19</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Facet_wrap</h1>
<h4 class="author">RLT</h4>
<h4 class="date">6/30/2020</h4>

</div>


<pre class="r"><code>library(ggplot2)
library(ggversa)
library(lubridate)
library(tidyverse)</code></pre>
<div id="gráficos-por-categoría-con-facet_wrap" class="section level1">
<h1>Gráficos por categoría con <strong>facet_wrap</strong></h1>
</div>
<div id="facet_wrap-descripción-general" class="section level1">
<h1><strong>Facet_wrap</strong>: Descripción general</h1>
<p>En este modulo se muestra una de las grandes ventajas de usar ggplot2. Para la producción de un gráfico por diferentes grupos o categorías, se usa la opción de <strong>facet_wrap()</strong>; o sea, cada grupo genera la producción de un gráfico. Por ejemplo, observe en la Figura que cada localidad de muestreo genera su propio gráfico. Para lograr esos cuatro gráficos, se necesitaron tres variables, en que por lo menos una es categórica. En este ejemplo se representa la cantidad de <em>Anolis</em> muestreado en el periodo seco y lluvioso separado por las cuatro localidades en el bosque usando geom_bar. Note la tilde, <strong>~</strong>, antes del nombre de la variable categórica <strong>Survey_Site</strong>.</p>
<pre class="r"><code>barraA=ggplot(Anolis, aes(SEX_AGE, fill=SEASON))
barraA+geom_bar()+  
  facet_wrap(~Survey_Site)+
  labs(y=&quot;Frecuencia&quot;, x=&quot;Género y edad&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
<p>En el próximo gráfico se usa <strong>geom_point</strong> combinado con <strong>facet_wrap</strong> con las variables de tamaño de los <em>Anolis</em> y la altitud del lugar de muestreo en donde el lagarto fue encontrado.</p>
<pre class="r"><code>barraC=ggplot(Anolis, aes(SVL, HEIGHT))
barraC+geom_point()+
  facet_wrap(~Survey_Site)+
  labs(y=&quot;Altura del muestreo&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap1-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
<div id="facet_wrap-gráficos-en-una-fila" class="section level2">
<h2><strong>Facet_wrap</strong>: Gráficos en una fila</h2>
<p>Para cambiar la cantidad de columnas o filas se usa <strong>nrow</strong> y <strong>ncol</strong>. En el ejemplo ponemos todos los gráficos en una fila con <strong>nrow</strong> igual a 1.</p>
<pre class="r"><code>barraD=ggplot(Anolis, aes(SVL, HEIGHT))
barraD+geom_point()+
  facet_wrap(~Survey_Site, nrow=1)+
  labs(y=&quot;Altitud&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap2-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="facet_wrap-gráficos-en-una-columna" class="section level2">
<h2>Facet_wrap: Gráficos en una columna</h2>
<p>Por otro lado, en el próximo ejemplo reorganizamos los gráficos para que queden uno debajo de los otros en una columna con <strong>ncol</strong> igual a 1.</p>
<pre class="r"><code>barraC=ggplot(Anolis, aes(SVL, HEIGHT))
barraC+geom_point()+
  facet_wrap(~Survey_Site, ncol=1)+
  labs(y=&quot;Altitud&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap3-1.png" width="672" style="display: block; margin: auto;" /> ***</p>
</div>
<div id="facet_wrap-con-escala-libre" class="section level2">
<h2><strong>Facet_wrap</strong>: Con escala libre</h2>
<p>A veces queremos tener los gráficos por categoría sobre la misma columna <strong>ncol=1</strong> pero que a la misma vez la escala de cada grupo se refleje de acuerdo a los datos. Note que en el gráfico anterior todas los gráficos tienen la misma escala de 0 a 60. Si queremos que las escalas en los ejes de <strong>X</strong> y <strong>Y</strong> queden ajustadas de acuerdo a los datos de cada grupo, se utiliza la opción y parámetro <strong>(scales=“free”)</strong> . Note en la Figura que ahora cada gráfico tiene su propria escala:</p>
<pre class="r"><code>barraC=ggplot(Anolis, aes(SVL, HEIGHT))
barraC+geom_point()+
  facet_wrap(~Survey_Site, ncol=1, scales=&quot;free&quot;)+
  labs(y=&quot;Altitud&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap3a-1.png" width="672" style="display: block; margin: auto;" /> ***</p>
</div>
<div id="facet_wrap-con-múltiples-variables" class="section level2">
<h2><strong>Facet_wrap</strong>: Con múltiples variables</h2>
<p>Podríamos también querer organizar los gráficos de acuerdo a múltiples variables categóricas mostrando así la agrupación de los datos. En el ejemplo se agrupan de acuerdo al sitio de muestreo (Gap, North, South o Woods) y al periodo del año (seco o mojado). De esta forma, se pueden producir gráficos agrupados por múltiples variables discretas. Note que lo único que se tuvo que hacer fue añadir <strong>~variable1 + variable2</strong>; en nuestro caso, <strong>~Survey_Site + SEASON</strong>.</p>
<pre class="r"><code>barraE=ggplot(Anolis, aes(SVL, HEIGHT))
barraE+geom_point()+
  facet_wrap(~Survey_Site+SEASON)+
  labs(y=&quot;Altitud&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap4-1.png" width="672" style="display: block; margin: auto;" /> ***</p>
</div>
<div id="facet_wrap-mostrar-los-grupos-aunque-no-tengan-datos" class="section level2">
<h2><strong>Facet_wrap</strong>: Mostrar los grupos aunque no tengan datos</h2>
<p>En el ejemplo que hemos estado mostrando hay localidades en que no hay datos, como en Gap Tower en la época lluviosa, en South Tower en la época seca, y en Woods Walkway Tower en la época lluviosa, y por eso no aparecen en la figura. Si queremos mostrar los gráficos de esos sitios donde no existe información, se usa la opción de <strong>drop = FALSE</strong>.</p>
<pre class="r"><code>barraE=ggplot(Anolis, aes(SVL, HEIGHT))
barraE+geom_point()+
  facet_wrap(~Survey_Site+SEASON,drop=FALSE)+
  labs(y=&quot;Altitud&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap4a-1.png" width="672" style="display: block; margin: auto;" /> ***</p>
</div>
<div id="cambiando-la-escala-con-scales" class="section level2">
<h2>Cambiando la escala con <strong>scales</strong></h2>
<p>En la Figura anterior todos los graficos muestran la misma escala para cada uno. Para que cada uno tenga su propia escala, nuevamente usamos <strong>scales=free</strong>.</p>
<pre class="r"><code>barraF=ggplot(Anolis, aes(SVL, HEIGHT))
barraF+geom_point()+
  facet_wrap(~Survey_Site, scales=&quot;free&quot;)+
  labs(y=&quot;Altitud&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap5-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="solapamiento-de-datos-entre-los-grupos" class="section level2">
<h2>Solapamiento de datos entre los grupos</h2>
<p>A veces puede ser más fácil interpretar los datos y la distribución de un grupo si estos están solapados con los datos de los otros grupos, especialmente si se usan colores diferentes por grupo. Una alternativa es graficar todos los datos en cada uno de los gráficos individuales, pero que los que no son del gráfico que no se quiere resaltar se muestren en un color más atenuado, mientras que los datos que se quieren resaltar salgan en un color más prominente. Para lograr ese efecto, a continuación se crea un nuevo data frame con <strong>data = transform(Anolis, Survey_Site = NULL)</strong> basándonos en el data frame anterior. Con la opción NULL estamos removiendo la variable que usamos para hacer el facetting; o sea, la distribución de datos por categoría, que en nuestro caso es <strong>Survey_Site</strong>. También se le añade un color diferente a los cuatro grupos. Note que el código para el color atenuado, en este caso <strong>grey85</strong>, tiene que escribirse antes del código que graficará la variable que queremos resaltar con color <strong>Survey_Site</strong>, ya que esta última estará en una capa superior y, a consecuencia, se esconderán algunos de los puntos de la capa inferior.</p>
<pre class="r"><code>ggplot(Anolis, aes(x=SVL, y=HEIGHT, colour=Survey_Site))+
  geom_point(data = transform(Anolis,
            Survey_Site = NULL), colour = &quot;grey85&quot;)+
  geom_point()+
  facet_wrap(~Survey_Site)+
  labs(y=&quot;Altitud&quot;)+
  theme(legend.position=&quot;none&quot;)</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap6-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="cambiar-la-posición-del-nombre-del-grupo-en-el-eje-de-x" class="section level2">
<h2>Cambiar la posición del nombre del grupo en el eje de <strong>X</strong></h2>
<p>Para que el nombre de cada grupo salga debajo de cada gráfico en el eje de <strong>X</strong>, usar strip.position = “bottom”, “top”, “left”, “right”:</p>
<pre class="r"><code>ggplot(Anolis, aes(x=SVL, y=HEIGHT, colour=Survey_Site))+
  geom_point(data = transform(Anolis,
            Survey_Site = NULL), colour = &quot;grey85&quot;)+
  geom_point()+
  facet_wrap(~Survey_Site, strip.position = &quot;bottom&quot;)+
  labs(y=&quot;Altitud&quot;)+
  theme(legend.position=&quot;none&quot;)</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap6a-1.png" width="672" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="cambiar-el-nombre-del-grupo-al-eje-de-y" class="section level2">
<h2>Cambiar el nombre del grupo al eje de <strong>Y</strong></h2>
<p>El nombre de cada grupo se cambia al eje de Y al usando la función <strong>switch=y</strong>.</p>
<pre class="r"><code>ggplot(Anolis, aes(x=SVL, y=HEIGHT, colour=Survey_Site))+
  geom_point(data = transform(Anolis,
            Survey_Site = NULL), colour = &quot;grey85&quot;)+
  geom_point()+
  facet_wrap(~Survey_Site, strip.position = &quot;left&quot;)+
  labs(y=&quot;Altitud&quot;)+
  theme(legend.position=&quot;none&quot;)</code></pre>
<pre><code>## Warning: Removed 1232 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 308 rows containing missing values (geom_point).</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap6b-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="demostración-con-datos-climatológicos" class="section level1">
<h1>Demostración con datos climatológicos</h1>
<p><strong>Facet_wrap</strong> se puede usar en combinación con todas las funciones tipo <strong>geom</strong>. A continuación se demostrará un ejemplo con <strong>geom_line</strong>. Para visualizar las ventajas de esa combinación, utilizaremos datos sobre las temperaturas mínimas diurnas de la ciudad de Morelia, Michoacán, México, disponible en CLIMCOM, <a href="http://clicom-mex.cicese.mx" class="uri">http://clicom-mex.cicese.mx</a>. Los datos del archivo original van de noviembre 1947 a marzo del 2012. A continuación solo se mostrarán del 1951 hasta el 1959. Note que aparecen todos los años juntos, lo que lo hace un poco difícil de analizar. Para reproducir este gráfico, primero hay que instalar y activar la librería <strong>lubridate</strong> que se usará para manipular los datos relacionados a las fechas. En el paquete <strong>lubridate</strong> se encuentra una serie de funciones para reorganizar y manipular datos de fechas y horas en distintos formatos. El segundo paso es seleccionar solamente los datos de interés con la opción <strong>with</strong>. El tercer paso es convertir los datos de fecha que estén en tres columnas, <strong>Mes</strong>, <strong>Dia</strong> y <strong>Year</strong> (o <strong>Año</strong>), y crear una columna de fecha donde la organización de la fecha es año-mes-día. El paso final es convertir la fecha al día del año (1-365).</p>
<p>Veamos las primeras filas del archivo, donde en la primera se muestra que en el 8 de octubre de 1947 la temperatura mínima fue de 11C°.</p>
<pre class="r"><code>head(MORELIA.MICH.Tmin)</code></pre>
<pre><code>##   Mes Dia Year Tmin
## 1  10   8 1947 11.0
## 2  10   9 1947 11.0
## 3  10  10 1947  9.0
## 4  10  11 1947 10.0
## 5  10  12 1947 12.0
## 6  10  13 1947 12.5</code></pre>
<p>Ahora se selecciona solamente parte de los datos, del 1 de enero del 1951 al 31 de diciembre del 1959.</p>
<pre class="r"><code>MM=MORELIA.MICH.Tmin%&gt;%
  filter(Year&gt;1950 &amp; Year&lt;1960)</code></pre>
<div id="unir-columnas-de-fecha-en-una-variable-tde-tiempo" class="section level2">
<h2>Unir columnas de fecha en una variable tde tiempo</h2>
<p>Ahora se define la variable para la fecha con la función <strong>ymd</strong> para indicar que el orden de la fecha es año-mes-día. También se identifica cuántos dígitos tiene cada elemento de la fecha utilizando <strong>%04</strong> para 4 cifras para el año y <strong>%02</strong> para dos cifras para mes y día. Subsiguientemente se identifica a cuál columna corresponde ubicar a cada uno.</p>
<pre class="r"><code>library(lubridate)
MM$fecha &lt;- with(MM, ymd(sprintf(&#39;%04d%02d%02d&#39;,
                                 Year, Mes, Dia)))
head(MM)</code></pre>
<pre><code>##   Mes Dia Year Tmin      fecha
## 1   1   1 1951  4.0 1951-01-01
## 2   1   2 1951 10.0 1951-01-02
## 3   1   3 1951  1.0 1951-01-03
## 4   1   4 1951  1.0 1951-01-04
## 5   1   5 1951  1.5 1951-01-05
## 6   1   6 1951  3.0 1951-01-06</code></pre>
</div>
<div id="cambiando-la-fecha-en-posición-de-1-al-365-del-año" class="section level2">
<h2>Cambiando la fecha en posición de 1 al 365 del año</h2>
<p>Con la función <strong>yday</strong> se puede identificar cuál día de los 365 del año es que corresponde dentro de cada una de las fechas. Por ejemplo, el primero de enero corresponde al día 1 y el día 15 de febrero corresponde al día 46 del año (31 días de enero más los 15 días de febrero), y así sucesivamente. La nueva variable <strong>diaanual</strong> recoge esa información:</p>
<pre class="r"><code>library(lubridate)
MM$diaanual=yday(MM$fecha)
tail(MM)</code></pre>
<pre><code>##      Mes Dia Year Tmin      fecha diaanual
## 3282  12  26 1959  1.1 1959-12-26      360
## 3283  12  27 1959  1.7 1959-12-27      361
## 3284  12  28 1959  1.1 1959-12-28      362
## 3285  12  29 1959  0.0 1959-12-29      363
## 3286  12  30 1959 -0.6 1959-12-30      364
## 3287  12  31 1959 -1.1 1959-12-31      365</code></pre>
<p>Veamos ahora el resultado. El gráfico de la figura produce una línea por cada año. Note que hay que identificar que el año es un factor usando <strong>color=factor(Year)</strong>. Si no se hace así, el año se interpretará como un valor continuo.</p>
<pre class="r"><code>ggplot(MM, aes(x=diaanual, y=Tmin, color=factor(Year)))+
  geom_line()+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))+
  xlab(&quot;Día del año&quot;)+
  ylab(&quot;Temperatura mínima&quot;)</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap7e-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="facet_wrap-climatológico" class="section level2">
<h2><strong>Facet_wrap</strong> climatológico</h2>
<p>Como podemos apreciar en la Figura las líneas que representan las fechas son muy difíciles de analizar debido al solapamiento. Ahora utilizamos <strong>facet_wrap</strong> para que aparezcan separadas por la categoría de año, <strong>Year</strong>. Note la tilde en <strong>facet_wrap</strong>, <strong>~</strong>, antes del nombre de la variable categórica, <strong>Year</strong>.</p>
<pre class="r"><code>ggplot(MM, aes(x=diaanual, y=Tmin, color=factor(Year)))+
  geom_line()+
  facet_wrap(~Year)+
  theme(legend.position=&quot;none&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))+
  xlab(&quot;Día del año&quot;)+
  ylab(&quot;Temperatura mínima&quot;)</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap8-1.png" width="672" /></p>
</div>
<div id="modificar-el-orden-en-que-se-presentan-los-gráficos" class="section level2">
<h2>Modificar el orden en que se presentan los gráficos</h2>
<p>Por omisión, los gráficos van a la horizontal primero (de izquierda a derecha) y luego hacia abajo. Si se desea que bajen a la vertical primero (de arriba para abajo) y luego a la izquierda, se usa la opción <strong>dir</strong>. De esa manera, se puede notar que ahora se llena la primera columna, después la segunda y luego la tercera columna, y así sucesivamente. Para lograr ese efecto se utilizó la opción <strong>dir=v</strong> en la función <strong>facet_wrap</strong>, <strong>v</strong> de vertical; o sea, que baje a la vertical primero.</p>
<pre class="r"><code>ggplot(MM, aes(x=diaanual, y=Tmin, color=factor(Year)))+
  geom_line()+
  facet_wrap(~Year, dir=&quot;v&quot;)+
  theme(legend.position=&quot;none&quot;)+
  labs(y=&quot;Temperatura mínima&quot;, x=&quot;Día del año&quot;)+
  theme(axis.title=element_text(size=10,face=&quot;bold&quot;))</code></pre>
<p><img src="G10_Facet_wrap_files/figure-html/facetwrap9-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="opciones-y-parametros-de-facet_wrap" class="section level1">
<h1>Opciones y Parametros de <strong>facet_wrap</strong>:</h1>
<ul>
<li><p>ggplot(el archivo de datos, aes(la variable continua))</p>
<ul>
<li><p>facet_wrap(<span class="math inline">\(\sim\)</span> a + b, scales, nrow, ncol, switch, drop, dir)</p></li>
<li><p>facet: <span class="math inline">\(\sim\)</span> a + b o se puede usar un vector c(a + b)</p></li>
<li><p>scales: usar <strong>free</strong> si se quiere que las escalas sean determinadas por los gráficos individualmente o que todos los gráficos tengan la misma escala</p></li>
<li><p>nrow: la cantidad de filas</p></li>
<li><p>ncol: la cantidad de columnas</p></li>
<li><p>switch: presenta la identificación de la categoría abajo cuando se usa <strong>X</strong>, y a la izquierda cuando se usa Y</p></li>
<li><p>drop: añadir drop = FALSE para que muestre también las variables que no tienen información</p></li>
<li><p>dir: dirección <strong>h</strong> para horizontal y <strong>v</strong> vertical <strong>h</strong> es la dirección predeterminada</p></li>
</ul></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
